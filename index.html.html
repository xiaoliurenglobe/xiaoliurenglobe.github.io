<!doctype html>
<html lang="zh" translate="no">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google" content="notranslate" />
  <title>å°å…­å£¬å åœ</title>
  
  <!-- å…¨å±€è„šæœ¬ï¼šå¤„ç†éŸ³ä¹ã€èƒŒæ™¯ã€ä»˜è´¹ -->
  <script>
    // ==================== 1. èƒŒæ™¯å›¾ç®¡ç† ====================
    const modalBackgrounds = {
      'å¤§å®‰': ['/modal-peace-1.jpg', '/modal-peace-2.jpg'],
      'ç•™è¿': ['/modal-linger-1.jpg', '/modal-mist-forest.jpg'],
      'é€Ÿå–œ': ['/modal-joy-1.jpg', '/modal-sunrise.jpg'],
      'èµ¤å£': ['/modal-storm.jpg', '/modal-dark.jpg'],
      'å°å‰': ['/modal-luck-1.jpg', '/modal-stream.jpg'],
      'ç©ºäº¡': ['/modal-void-1.jpg', '/modal-starry.jpg'],
      'default': ['/modal-moon-lake.jpg', '/modal-bamboo.jpg', '/modal-lotus.jpg']
    };

    // ==================== 2. éŸ³ä¹æ’­æ”¾ ====================
    window.playBackgroundMusic = function(result) {
      // æ‰¾åˆ°å·²æœ‰çš„ audio å…ƒç´ 
      let audio = document.querySelector('audio[src="/bgm.mp3"]');
      if (!audio) {
        // å¦‚æœæ²¡æœ‰ï¼Œåˆ›å»ºä¸€ä¸ª
        audio = document.createElement('audio');
        audio.src = '/bgm.mp3';
        audio.loop = true;
        document.body.appendChild(audio);
      }
      
      // è®¾ç½®30%éŸ³é‡å¹¶æ’­æ”¾
      audio.volume = 0.3;
      audio.play().catch(e => console.log('æ’­æ”¾å¤±è´¥', e));
      
      // åŒæ—¶è®¾ç½®èƒŒæ™¯å›¾
      setModalBackground(result);
    };

    // ==================== 3. è®¾ç½®å¼¹çª—èƒŒæ™¯ ====================
    function setModalBackground(result) {
      // é€‰æ‹©å›¾ç‰‡æ± 
      let pool = modalBackgrounds[result] || modalBackgrounds.default;
      const bgImage = pool[Math.floor(Math.random() * pool.length)];
      
      // ä¿å­˜åˆ°å…¨å±€
      window.__modalBgImage = bgImage;
      
      // ç«‹å³åº”ç”¨åˆ°å½“å‰å¼¹çª—ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
      const modal = document.querySelector('.fixed.inset-0.z-\\[100\\] .relative');
      if (modal) {
        modal.style.backgroundImage = `url('${bgImage}')`;
        modal.style.backgroundSize = 'cover';
      }
    }

    // ==================== 4. ç›‘å¬ç»“æœç‚¹å‡» ====================
    document.addEventListener('click', function(e) {
      // æŸ¥æ‰¾è¢«ç‚¹å‡»çš„å…ƒç´ æ˜¯å¦æ˜¯è½¬ç›˜ç»“æœ
      const resultElement = e.target.closest('[class*="result"], [class*="Result"], .cursor-pointer');
      if (resultElement) {
        // å°è¯•è·å–ç»“æœæ–‡å­—ï¼ˆå¤§å®‰/ç•™è¿/é€Ÿå–œç­‰ï¼‰
        const text = resultElement.textContent || '';
        const result = text.match(/(å¤§å®‰|ç•™è¿|é€Ÿå–œ|èµ¤å£|å°å‰|ç©ºäº¡)/);
        if (result) {
          window.playBackgroundMusic(result[0]);
        }
      }
    });

    // ==================== 5. è§‚å¯Ÿå¼¹çª—å‡ºç° ====================
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.addedNodes.length) {
          mutation.addedNodes.forEach((node) => {
            if (node.nodeType === 1) {
              // æ£€æµ‹å¼¹çª—å‡ºç°
              if (node.querySelector('input[type="password"]') || 
                  node.textContent.includes('password') ||
                  node.textContent.includes('å¯†ç ')) {
                
                // å¼¹çª—å‡ºç°åï¼Œä¿®æ”¹å…¶ç»“æ„ï¼Œæ·»åŠ ä»˜è´¹/å¯†ç äºŒé€‰ä¸€
                setTimeout(() => {
                  enhanceModal(node);
                }, 100);
              }
            }
          });
        }
      });
    });
    
    observer.observe(document.body, { childList: true, subtree: true });

    // ==================== 6. å¢å¼ºå¼¹çª— ====================
    function enhanceModal(modalNode) {
      // æ‰¾åˆ°å¼¹çª—å†…å®¹åŒºåŸŸ
      const contentArea = modalNode.querySelector('.p-6') || modalNode;
      
      // è®¾ç½®èƒŒæ™¯å›¾
      if (window.__modalBgImage) {
        modalNode.querySelector('.relative')?.style.setProperty('background-image', `url('${window.__modalBgImage}')`, 'important');
      }
      
      // æ·»åŠ ä»˜è´¹/å¯†ç é€‰é¡¹ï¼ˆå¦‚æœè¿˜æ²¡æœ‰çš„è¯ï¼‰
      if (!modalNode.querySelector('.payment-options')) {
        const paymentDiv = document.createElement('div');
        paymentDiv.className = 'payment-options mt-4 border-t pt-4';
        paymentDiv.innerHTML = `
          <div class="flex gap-2 mb-3">
            <button class="tab-btn active flex-1 py-2 bg-amber-500 text-white rounded" data-tab="password">ğŸ”‘ å¯†ç è§£é”</button>
            <button class="tab-btn flex-1 py-2 bg-gray-200 dark:bg-gray-700 rounded" data-tab="wechat">ğŸ’° å¾®ä¿¡æ”¯ä»˜ 2å…ƒ</button>
          </div>
          
          <div id="password-tab" class="tab-content">
            <p class="text-sm opacity-70 mb-2">è¾“å…¥å¯†ç  "liuren2026" è§£é”</p>
            <div class="flex gap-2">
              <input type="password" placeholder="è¯·è¾“å…¥å¯†ç " class="flex-1 px-3 py-2 border rounded-lg">
              <button class="px-4 py-2 bg-amber-500 text-white rounded-lg">ç¡®è®¤</button>
            </div>
          </div>
          
          <div id="wechat-tab" class="tab-content hidden">
            <p class="text-sm text-center mb-2">å¾®ä¿¡æ‰«ç æ”¯ä»˜ 2å…ƒ</p>
            <div class="flex justify-center">
              <img src="/wechat-qr.jpg" alt="å¾®ä¿¡æ”¶æ¬¾ç " class="w-32 h-32 border rounded-lg">
            </div>
            <p class="text-xs text-center mt-2 opacity-60">æ”¯ä»˜åè‡ªåŠ¨è§£é”</p>
          </div>
        `;
        
        // æ’å…¥åˆ°å†…å®¹åŒºå‰é¢
        contentArea.insertBefore(paymentDiv, contentArea.firstChild);
        
        // æ·»åŠ é€‰é¡¹å¡åˆ‡æ¢åŠŸèƒ½
        paymentDiv.querySelectorAll('.tab-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            // åˆ‡æ¢æŒ‰é’®æ ·å¼
            paymentDiv.querySelectorAll('.tab-btn').forEach(b => {
              b.classList.remove('active', 'bg-amber-500', 'text-white');
              b.classList.add('bg-gray-200', 'dark:bg-gray-700');
            });
            this.classList.add('active', 'bg-amber-500', 'text-white');
            this.classList.remove('bg-gray-200', 'dark:bg-gray-700');
            
            // åˆ‡æ¢å†…å®¹
            const tab = this.dataset.tab;
            paymentDiv.querySelector('#password-tab').classList.toggle('hidden', tab !== 'password');
            paymentDiv.querySelector('#wechat-tab').classList.toggle('hidden', tab !== 'wechat');
          });
        });
        
        // å¯†ç è¾“å…¥ç¡®è®¤
        paymentDiv.querySelector('#password-tab button').addEventListener('click', function() {
          const input = paymentDiv.querySelector('#password-tab input');
          if (input.value === 'liuren2026') {
            alert('è§£é”æˆåŠŸï¼');
            paymentDiv.remove(); // ç§»é™¤ä»˜è´¹é€‰é¡¹
          } else {
            alert('å¯†ç é”™è¯¯');
          }
        });
        
        // æ¼”ç¤ºç”¨çš„æ”¯ä»˜æˆåŠŸæŒ‰é’®ï¼ˆå®é™…éœ€è¦åç«¯ï¼‰
        paymentDiv.querySelector('#wechat-tab').insertAdjacentHTML('beforeend', `
          <button class="w-full mt-2 py-2 bg-green-500 text-white rounded-lg text-sm">
            æˆ‘å·²æ”¯ä»˜ï¼ˆæ¼”ç¤ºç”¨ï¼‰
          </button>
        `);
      }
    }
  </script>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      transition: background-image 0.5s ease;
    }
    /* å¼¹çª—èƒŒæ™¯æ ·å¼ */
    .fixed.inset-0.z-\\[100\\] .relative {
      background-size: cover !important;
      background-position: center !important;
      position: relative;
      overflow: hidden;
    }
    .fixed.inset-0.z-\\[100\\] .relative::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.4);
      z-index: 0;
    }
    .fixed.inset-0.z-\\[100\\] .relative > * {
      position: relative;
      z-index: 1;
    }
    .dark .fixed.inset-0.z-\\[100\\] .relative::before {
      background: rgba(0,0,0,0.6);
    }
  </style>
  
  <script type="module" crossorigin src="./index-xWH0CqK6.js"></script>
  <link rel="stylesheet" crossorigin href="./index-DlgEhZsr.css">
</head>

<body>
  <div id="root"></div>
</body>
</html>